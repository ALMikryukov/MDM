<!DOCTYPE html>
{% load static %}
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="{% static 'styles/style.css' %}" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css"
    />
  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <div class="content">
            <div class="header_container">

            <div class="header-body__burger logo">
                <span>MDM</span>-MOTORS
            </div>
            <div class="header-body">
              <div class="header__menu">
                <ul class="header__menu-list">
                  <li>О компании</li>
                  <li>Как купить</li>
                  <li>Скачать прайс</li>
                </ul>
              </div>

              <div class="header-body__main">
                <div class="header-body__logo logo">
                  <span>MDM</span>-MOTORS
                </div>
                <div class="header-body__basket">
                  <img src="{% static 'img/header/basket.svg' %}" alt="" />
                  <p>Корзина</p>
                </div>
              </div>
              <div class="header-body__search">
                <input type="search" placeholder="Поиск" />
                <button>
                  <img src="{% static 'img/header/search.svg' %}" alt="" />
                </button>
              </div>
            </div>
            <div class="header__burger">
              <span></span>
            </div>
          </div>
        </div>
      </header>

      <section class="model section">
        <div class="__container">
          <div class="model-body">
            <div class="sidebar">
              <div class="path">
                <a href="{% url 'main' %}">Главная</a> /
                <a href="">{{ model.brand }}</a>
                / <a href="#">{{ model.name }}</a> /
              </div>
              <ul id="accordion" class="accordion">
                {% for brand in brands %} {% if brand.models.count > 0 %}
                <li>
                  <div class="link">
                    <i class="fa fa-database"></i>{{ brand.name }}<i
                      class="fa fa-chevron-down"
                    ></i>
                  </div>
                  <ul class="submenu">
                    {% for mod in brand.models.all %}
                    <li><a href="{% url  'model'  mod.id %}">{{ mod }}</a></li>
                    {% endfor %}
                  </ul>
                </li>
                {% endif %} {% endfor %}
              </ul>
            </div>

            
            <div class="model-item">
                <div class="model-item__title title">
                    Запчасти для Audi 100 [C4] 1991-1994
                  
                </div>
                
                <div class="model-item__img">
                    <img src="/src/img/12.png" alt="">
                </div>
                <div class="products__title title">
                    Амортизатор капота для Audi 100 [C4] 1991-1994
                
                </div>
                <div class="products">
                    {% for app in apps %}
                  <div class="product">
                      <div class="product-img">
                          <img src="{{ app.featured_image.url }}" alt="" width="150" >
                      </div>
                          <div class="product-body">
                              <div class="product-header">
                                  <div class="product-title">
                                      {{app.name}} для {{model.brand}} {{model.name}}
                                    
                                  </div>
                                  <span class="status new">
                                      Новое
                                  </span>
                              </div>
                              <div class="product-info">
                                  <div class="product-info__right">
                                      <div class="product-info__number">
                                          <p>Номер:</p> <p>{{app.brand}} {{app.oem}} </p>
                                      </div>
                                      <div class="product-info__country">
                                          <p>Страна производителя:</p> <p>Китай</p>
                                      </div>
                                  </div>
                                  
                                  <div class="product-info__left">
                                      <div class="product-price">
                                          {{app.price}} p 
                                          <p>В наличии</p>
                                      </div>
                                  </div>
                              </div>
                              <div class="productMain-info__button product-more">
                                  <button data-id="{{ app.id }}" onclick="getVideoInfo( this.dataset.id )">Подробнее</button>
                              </div>
                          </div>
                          </div>
                    {% endfor %}
              </div>
            </div>
            </div>
        </div>
        
    </section>
</div>
    <footer class="footer">
      <div class="content">
        <div class="footer-body">
          <div class="footer-logo logo"><span>MDM</span>-MOTORS</div>
          <div class="footer-menu">
            <ul>
              <li>О компании</li>
              <li>Как купить</li>
              <li>Скачать прайс</li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    {% include 'slider.html' %}
    {% csrf_token %}
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script>
    <script src="{% static 'js/productSlider.js' %}"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="{% static 'js/script.js' %}"></script>
    <script>
      function getVideoInfo(number) {
        $.ajax({
              url: '/test_path/' + number + '/',
              type:"POST",
              data: {
                  'csrfmiddlewaretoken': $('[name="csrfmiddlewaretoken"]').val(),
              },
              dataType: 'json',
              success: function (data) {
                  let jsonParse = JSON.parse(data['model']);
                  console.log(jsonParse);
                  document.querySelector('.price').innerHTML = jsonParse['price'];
                  document.querySelector('.overlay').classList.add('active');
                  document.querySelectorAll('.swiper-slide img').forEach(item => {
                    item.src = '/images/' + jsonParse['featured_image'];
                  })
              }
          });
      }
      function closeSlider() {
          document.querySelector('.overlay').classList.remove('active');
      }
    </script>
  </body>

</html>

